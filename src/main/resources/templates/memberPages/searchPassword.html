<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ğŸˆFind your Base:)-ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!--  í°íŠ¸-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nanum+Gothic&family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <style>
        *{
            font-family: 'Jua', sans-serif;
            font-family: 'Nanum Gothic', sans-serif;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .main{
            width: 400px;
            height: 409px;
            left: 411px;
            top: 85px;
            /*ê°€ìš´ë° ì •ë ¬ margin: auto*/
            margin-left: auto;
            margin-right: auto;
            margin-top: 150px;
        }
    </style>
</head>
<body style="background-color: white">
<th:block th:replace="commonPages/header :: header"></th:block>
<div class="main">
    <div class="email-container">
        <form action="/member/searchPassword" method="post">
            <label>ì´ë©”ì¼</label>
            <input type="text" class="width-450 form-control" name="memberEmail" id="memberEmail" onblur="check_emailPassword()" placeholder="ê°€ì…ì‹œ ì‚¬ìš©í•œ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
            <span id="emailError"></span>
            <input type="button" id="checkEmail" class="btn btn-outline-secondary" value="ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ì „ì†¡" onclick="sendPassword()">
            <input type="hidden" value="" id="searchPasswordCheck">
        </form>
    </div>
</div>




<script th:inline="javascript">
    // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ì „ì†¡
    const sendPassword = () => {
        console.log("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ì „ì†¡");

        $.ajax({
            type : "post",
            url : "/member/searchPassword",
            data : {
                "email" : document.getElementById("memberEmail").value
            },
            dataType:"text",
            success : function(data){
                if (data === "fail"){
                    alert("ì…ë ¥ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
                }else{
                    console.log(data);
                    alert("í•´ë‹¹ ì´ë©”ì¼ë¡œ ì„ì‹œë¹„ë°€ë²ˆí˜¸ë¥¼ ì „ì†¡í•˜ì˜€ìŠµë‹ˆë‹¤.")
                    document.getElementById("searchPasswordCheck").value = data;
                    console.log("data : "+data);
                    $.ajax({
                        type: "post",
                        url: "/member/searchPasswordUpdate",
                        data:{
                            "email" : document.getElementById("memberEmail").value
                        }
                    });
                    location.href="/member/login";
                }
            }
        })
    }


</script>
</body>
</html>